---
title: Non-Volumetric DDoS - The Elegant Way
---


>"In computing, a denial-of-service attack (DoS attack) is a cyber-attack in which the perpetrator seeks to make a machine or network resource unavailable to its intended users by temporarily or indefinitely disrupting services of a host connected to the Internet. Denial of service is typically accomplished by flooding the targeted machine or resource with superfluous requests in an attempt to overload systems and prevent some or all legitimate requests from being fulfilled." Wikipedia

Generally when people hear the word DoS or DDoS, first thought that comes to mind is flooding a system with lots of request and hindering it inaccessible. These types of denial of service attacks are called Volumetric DoS Attacks. A volumetric attack sends a high amount of traffic, or request packets, to a targeted network in an effort to overwhelm its bandwidth capabilities. These attacks work to flood the target in the hopes of slowing or stopping their services. There are multiple types of volumetric attacks including but not limited to; ICMP flood, SYN flood, UDP flood, ACK flood etc. Volumetric attacks are pretty straightforward for both attackers and defenders as they are not not complicated to do and mitigate, but we will not be covering this topic.

## What makes a DDoS Non-Volumetric?
 
A non-volumetric DDoS attack consists of ways that exhausts specific resources on the target, other than network bandwith. These resources include CPU usage, connections, HTTP session limits, back-end database queries and so on. The goal of non-volumetric DDoS attacks are the same as volumetric attacks but without flooding the target with large amounts of network packets. %70 of the recorded non-volumetric DDoS attacks are under 100 MBps as stated in the Radware research.
https://security.radware.com/ddos-knowledge-center/ddos-chronicles/ddos-attacks-history/
This is why we generally hear about volumetric attacks like 1.2 TBps github attack while the non-volumetric attacks get ignored.

## How does one make a Non-Volumetrics DDoS attack?
 
There are a lot of ways to perform non-vulmetric DDoS attack, I might even say it is limited by your imagination and your definition of "denial of service". I will be mentioning a few niche ones and a few known ones.

### HTTP Attacks
 
One of the main ways of doing a non-volumetric DDoS attack is through HTTP. These type of attacks revolves around manipulating HTTP connection and tricking the victim to think that an "evil" request is legitimate. First, lets take a look at what HTTP connection is;

First, the client establishes a TCP connection, the good old 3-way handshake;

![image](/img/handshake.png)

After the handshake, a connection is formed between client and server. This is when the client sends a request and the server returns an appropriate answer. As of HTTP/1.1 the connection is no longer closed after completing the third phase, and the client is now granted a further request: this means the second and third phases can now be performed any number of times.

Now, a web server is only allowed to establish a limited amount of connections, when this limit is reached, any other user will not be able to access the server. If an attacker makes enough http connections on the targer server and [maintains] these connections, it is called a Non-Volumetric HTTP DDoS attack. This attack  aims to exhaust the allowed connection for web servers without affecting bandwidth or other services. For example, when an attacker sends a valid HTTP request with 'content-type' header, server will receive the request, a connection will be opened and server will wait for the number of bytes to be declared in the 'content-length' header. Sending the message at the slowest rate possible that is just a little lower then timeout value(1 bytes/100 seconds in most cases) will cause the server to wait and maintain the connection which may take a long time. If the attacker holds all the connections, no one will be able to connect to server. This type of attack is also called SlowLoris or Are You Dead Yet?(R.U.D.Y). 

Other attack methods such as Slow Read also works on same principle. Attacker sends a legitimate HTTP requests but reads responses very slowly, thus, exhausting servers connection pool. This method is achieved by declaring a very small number for the TCP Receive Windows size(TCP receive buffer for incoming data that has not been processed yet by the application) and emtpying the clients TCP receive buffer slowly. This process ensures a very low dataflow rate. The traffic generated by the attacker will look legitimate, making these types of attack hard to detect and therefore possible to bypass protection systems.

#### IP Spoofing
 
IP packets contain a source IP address which can be easily spoofed. When a spoofed packet received, the receiver will process the packet and interpret the source IP as the sender and response back to sender. Makes sense, right? However, if an attacker changes the source IP address, target will receive the packet, and response back to the spoofed address. This method may cause denial of service issues for the spoofed IP address. In this scenario, attacker wants to prevent the victim from accessing a certain target.

Let's imagine that Client A is sending packets to Server X which contains source IP of Client B. Server A recieves these packets and decideds that these packets are part of a DoS attack, so Server X blocks the IP address of Client B. Unnaware from the situation, when Client B wants to access Server A, it's packets will be blocked by Server X, thus, Client A will be causing a DoS attack for Client B. Foe xample, if an attacker does IP spoofing against a DNS server, it may cause serious problems for the victim.

![image](/img/topology.png)

### Exploiting Business Logic
 
This type of DoS occurs when a function used by an application is not thought thoroughly. It is especially hard to generalize and define this attack because it might apper on any given application or function. These type of DoS attacks are hard to detect because usually the network traffic itself is legal and legitimate. This is also why these attacks are impossible to block by DoS prevention mechanisms without detecting the source of problem. Best way to describe these types of attacks are I believe done by giving examples;

- Imagine an online banking application. Users log in by providing their social security number(widely used in Turkey) and password. If users enter their passwords incorrectly more than 5 tries in a minute, account gets locked down and needs certain process to unlock. In this scenario, if an attacker can enumarate usernames and brute forces passwords, lots of user accounts could get locked. I've actually experienced this situation in one of my penetration tests against a bank.

- Companies usually have a "Contact" page on their websites. Some of them uses this forms like below.

![image](/img/contactform.png)

If this form does not contain a CAPTCHA and it is direcly linked to an issue tracking platform like JIRA, an attacker can feed lots of messages to the platform, making it reach its capacity or make it inoperable by flooding it. This scenario is also something I have encountered on one of my penetration tests.

- File upload forms are also important when it comes to exploiting applications with a denial of service mindset. If an upload function is left unchecked, attackers might upload massive files to server, which may exhaust the server's disk capacity, making it unusable.


As one can imagine, these types of vulnerabilites can show up in different ways depending on applications, functions, other components and languages. While there are numerous ways to defend against DDoS like getting behind a cloud service or getting help from ISP, it is important to analyze applications for non-volumetric denial of service vulnerabilities with a out of the box mindset. 
